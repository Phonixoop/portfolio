"use client";

import { useEffect, useState } from "react";
import { motion, type Variants } from "motion/react";
import { slideUp } from "./anim";
import SVGMorph from "~/app/components/me/svg-morph";
import SvgMorphGsap from "~/app/components/me/morph-gsap";

const helloPath =
  "M17.5 371.4C17.5 371.4 207.47 270.53 251.08 109.77C260.21 77.32 260.08 51.46 251.08 35.77C240.36 16.95 201.39 2.56002 175.53 67.71C147.71 137.82 123.31 444.95 131.42 390.19C139.53 335.43 165.42 213.95 231.31 207C268.97 203 280.86 230.58 284.14 254.92C286.108 270.078 285.089 285.474 281.14 300.24C273.97 327.52 260.67 397.91 314.65 397.1C381.58 396.1 446.56 343.21 474.2 312.61C505.3 276.44 505.3 241.97 493.47 222.36C476.73 192.44 424 189.36 400.68 239.09C373.86 296.16 409.78 382.22 470.08 394.39C530.38 406.56 613.78 376.47 704.38 206.1C734.24 147.94 757.23 91.39 750.52 56.02C743.08 16.81 690.78 1.52001 657.65 47.32C610.65 112.32 595.87 313.94 622.91 355.85C649.95 397.76 727.7 418.02 792.6 345.71C857.5 273.4 925.8 157.15 939.14 89.48C953.14 18.33 882.2 -5.15996 850.74 42.16C811.61 101.02 778.66 246.53 814.38 349.02C818.848 362.234 826.972 373.909 837.81 382.69C863.3 402.92 892.91 398.69 915.27 389.01C926.437 384.1 936.721 377.387 945.71 369.14C983.44 334.91 974.71 332.43 1010.29 241.61C1035.08 191.72 1096.08 177.39 1132.08 216.89C1138.01 223.488 1142.66 231.141 1145.77 239.45C1163.45 285.45 1152.58 319.45 1138.96 347.34C1126.96 371.96 1104.4 390.06 1077.51 395.25C1054.45 399.7 1029.14 394.9 1011.03 370.98C1005.27 363.228 1000.97 354.483 998.37 345.18C983.62 294.18 1002.51 256.42 1009.37 243.77C1015.55 232.38 1046.63 174.16 1112.79 201.53C1168.5 224.58 1213.45 178.22 1213.45 178.22";

export const helloPath2 =
  "M67 825.373C67 825.373 350.834 650.262 415.992 371.181C429.633 314.848 429.439 269.955 415.992 242.717C399.975 210.045 341.75 185.064 303.113 298.165C261.547 419.876 225.091 953.056 237.208 857.992C249.325 762.928 288.007 552.038 386.454 539.973C442.722 533.029 460.486 580.908 465.387 623.163C468.328 649.476 466.805 676.205 460.905 701.838C450.192 749.197 430.321 871.394 510.972 869.988C610.972 868.252 708.059 776.435 749.356 723.313C795.822 660.521 795.822 600.681 778.147 566.638C753.136 514.697 674.352 509.35 639.51 595.682C599.438 694.756 653.106 844.156 743.2 865.283C833.294 886.411 957.903 834.174 1093.27 538.411C1137.88 437.445 1172.23 339.274 1162.21 277.871C1151.09 209.802 1072.95 183.259 1023.45 262.768C953.226 375.608 931.143 725.622 971.544 798.378C1011.94 871.134 1128.11 906.305 1225.08 780.775C1322.04 655.244 1424.09 453.433 1444.02 335.958C1464.94 212.441 1358.95 171.662 1311.94 253.81C1253.48 355.991 1204.25 608.598 1257.62 786.521C1264.29 809.46 1276.43 829.728 1292.63 844.972C1330.71 880.092 1374.95 872.748 1408.36 855.944C1425.04 847.421 1440.41 835.767 1453.84 821.449C1510.21 762.026 1497.17 757.72 1550.33 600.056C1587.37 513.447 1678.51 488.57 1732.29 557.142C1741.16 568.597 1748.1 581.881 1752.75 596.307C1779.16 676.163 1762.92 735.187 1742.57 783.604C1724.65 826.345 1690.94 857.767 1650.76 866.776C1616.31 874.502 1578.49 866.169 1551.43 824.643C1542.82 811.186 1536.41 796.004 1532.52 779.855C1510.48 691.318 1538.7 625.767 1548.95 603.806C1558.19 584.033 1604.62 482.963 1703.47 530.477C1786.71 570.492 1853.87 490.011 1853.87 490.011";

const rect2 =
  "M3073.39 11.8721C4278.12 -0.490842 5479.94 7.07279 6688.55 18.1328H6688.59C6712.89 18.1649 6736.85 33.1105 6746.43 56.2559L6746.44 56.2686L6746.45 56.2822C6749.48 63.5029 6751.05 71.4072 6751.04 79.1963V3675.61L6738.54 3675.1L6738.53 3675.1L6676.35 3672.72C5370.58 3622.91 4057.02 3585.82 2754.91 3569.01L2754.8 3569L2754.69 3569.01C2282.73 3581.77 1814.53 3582.51 1344.97 3584.61H5.5V3572.64C8.48081 3112.01 26.9029 2651.44 58.0342 2191.76L58.04 2191.67L58.043 2191.59C84.9753 1474.13 81.0284 750.29 83.4707 30.6299V18.6113H95.4707L1021.26 18.6123C1363.56 18.6122 1705.05 18.6112 2047.54 18.6104C2390.14 18.7272 2731.03 15.0894 3073.39 11.8721H3073.39Z";

export default function Preloader() {
  const [index, setIndex] = useState(0);
  const [dimension, setDimension] = useState({ width: 0, height: 0 });
  const [showMorph, setShowMorph] = useState(false);

  useEffect(() => {
    setDimension({ width: window.innerWidth, height: window.innerHeight });
    setTimeout(() => {
      setShowMorph(true);
    }, 2000);
  }, []);
  if (dimension.width <= 0) return;
  const initialPath = `M0 0 L${dimension.width} 0 L${dimension.width} ${dimension.height} Q${dimension.width / 2} ${dimension.height + 300} 0 ${dimension.height}  L0 0`;
  // const initialPath = `M0 0H1080V1648.56C720 2010.48 360 2010.48 0 1648.56V0Z`;
  const targetPath = `M0 0 L${dimension.width} 0 L${dimension.width} ${dimension.height} Q${dimension.width / 2} ${dimension.height} 0 ${dimension.height}  L0 0`;

  const curve: Variants = {
    initial: {
      d: initialPath,
      transition: { duration: 0.7, ease: [0.76, 0, 0.24, 1] },
    },
    exit: {
      d: targetPath,
      transition: { duration: 1, ease: [0.76, 0, 0.24, 1], delay: 0.3 },
    },
  };

  return (
    <motion.div
      variants={slideUp}
      initial="initial"
      exit="exit"
      className={
        "bg-m-dark fixed z-[99] flex h-screen w-screen items-center justify-center"
      }
    >
      {dimension.height > 0 && (
        <>
          <svg
            className="absolute top-0 w-full"
            style={{ height: "calc(100% + 300px)" }}
          >
            <motion.path
              variants={curve}
              initial="initial"
              exit="exit"
              className="fill-m-dark"
            />
          </svg>
          <div className="z-10 flex h-screen w-screen flex-col items-center justify-center">
            {" "}
            {!showMorph ? (
              <motion.svg
                viewBox="0 0 1920 1080"
                className="w-6/12"
                // onAnimationComplete={() => setShowMorph(true)}
              >
                <motion.path
                  className="stroke-m-text fill-none stroke-[25px]"
                  d={helloPath2}
                  initial={{ pathLength: 0 }}
                  animate={{ pathLength: 1 }}
                  transition={{
                    duration: 1.1,
                    ease: [0.317, 0.803, 0.698, -0.024],
                  }}
                />
              </motion.svg>
            ) : (
              <SvgMorphGsap
                initialPath={helloPath2}
                morphPath={"M1865 43H54V1037H1865V43Z"}
                width={1920}
                height={1080}
                svgClassName="w-6/12"
                className="stroke-m-text fill-none stroke-[25px]"
                duration={1.3}
                repeat={0}
                yoyo={false}
              />
            )}
            {/* <Canvas
              camera={{ position: [0, 0, 150], fov: 65 }}
              style={{ width: 500, height: 500 }}
            >
              <TubeCurve />
            </Canvas> */}
          </div>
        </>
      )}
    </motion.div>
  );
}
